# Relatórios com RMarkdown {#relatorios}

O RMarkdown é um pacote no R que possibilita criar relatórios reprodutíveis. Este pacote possibilita a escrita em um arquivo do tipo `.Rmd`, onde é possível adicionar textos, códigos, os resultados dos códigos, e muito mais!

```{r echo=FALSE, out.width="80%", fig.align='center', fig.cap="Ilustração por <a href='https://github.com/allisonhorst/stats-illustrations'>Allison Horst</a>."}
knitr::include_graphics("https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/rmarkdown_wizards.png")
```

<!-- - Falar  sobre os pacotes que usamos com Rmarkdown   -->

Existem diversos pacotes que podem ser utilizados para ampliar as possibilidades de produtos que elaboramos com RMarkdown, que possibilitam criar/escrever:

- [blogdown](https://bookdown.org/yihui/blogdown/) e [distill](https://rstudio.github.io/distill/) - blogs e sites; 

- [bookdown](https://bookdown.org/) - livros (como este!);

- [xaringan](https://github.com/yihui/xaringan) - apresentações;

- [pagedown](https://github.com/rstudio/pagedown) - currículos, cartas, trabalhos acadêmicos;

- [learnr](https://rstudio.github.io/learnr/) - tutoriais interativos;

- [rticles](https://github.com/rstudio/rticles) - artigos científicos.


Para começar a utilizar RMarkdown e criar os produtos citados acima, confira o conteúdo disponível neste capítulo. Além disso, confira também as folhas de cola sobre RMarkdown:

  - [`rmarkdown` Cheatsheet](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf)
  
  - [`rmarkdown` Cheatsheet 2.0](http://www.rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf)
  

  
  


## Markdown

Se você é uma pessoa que utiliza R, sabe das possibilidades de utilizar R Markdown (e os pacotes que expandem mais ainda as possibilidades) e gostaria de começar a utilizá-lo, é importante conhecer Markdown. Por quê? O R Markdown utiliza a linguagem de marcação [Markdown](https://www.markdownguide.org/). Os arquivos markdown podem ser abertos por qualquer software que suporte este formato aberto. Além disso, independente da plataforma de trabalho, pode-se migrar para um arquivo de texto sem perder a formatação.

O Markdown também é usado em outros lugares, como no [GitHub](https://github.com/) e no [Fórum da Curso-R](https://discourse.curso-r.com).

Uma referência interessante para ter sempre em mãos é a Folha de cola (*Cheatsheet*) do [Markdown](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet).


### Ênfase

#### Negrito 

Para destacar um texto em negrito, coloque `**` ou `__` ao redor do texto.

Por exemplo:

|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
|`Esse é um texto com uma palavra destacada em **negrito**.`|  Esse é um texto com uma palavra destacada em **negrito**.| 
|`Esse é um texto com uma palavra destacada em __negrito__.`|  Esse é um texto com uma palavra destacada em **negrito**.| 




#### Itálico

Para destacar um texto em itálico, coloque `*` ou `_` ao redor do texto.

Por exemplo:

|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
|`Esse é um texto com uma palavra destacada em *itálico*.`|  Esse é um texto com uma palavra destacada em *itálico*.| 
|`Esse é um texto com uma palavra destacada em _itálico_.`|  Esse é um texto com uma palavra destacada em *itálico*.| 

#### Riscado (ou tachado)

Para riscar/tachar um texto, coloque `~~` ao redor do texto.

Por exemplo:

Esse é um texto com uma palavra ~~riscada/tachada~~.

|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
|`Esse é um texto com uma palavra ~~riscada/tachada~~.`| Esse é um texto com uma palavra ~~riscada/tachada~~.| 


### Títulos

Os títulos funcionam como uma hierarquia, e para criar um título é necessário colocar um `#` no início da linha. Então um `#` marca um título, `##` marca um sub-título, e assim sucessivamente. Veja os exemplos:


|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
| `# Título 1` <br> `## Título 2` <br> `### Título 3` |  `r knitr::include_graphics("https://beatrizmilz.github.io/slidesR/markdown/images/titulos.png")`| 


### Listas

#### Listas ordenadas

Você pode fazer uma lista ordenada usando somente números. Você pode repetir o número quantas vezes quiser:




Como é escrito no código: 

> `1. Maçã`
> 
> `1. Banana`
> 
> `1. Uva`

Como aparece no relatório:


> 1. Maçã
> 1. Banana
> 1. Uva





#### Listas não ordenadas

Você pode fazer uma lista não ordenada escrevendo com hífens ou asteriscos, como a seguir:


>
>
> `* Maçã`
>
> `* Banana`
>
> `* Uva`

>
>
> `- Maçã`
>
> `- Banana`
>
> `- Uva`

O resultado será:

>
> - Maçã
> - Banana
> - Uva

Você também pode adicionar sub-itens na lista indicando a hierarquia através da identação no Markdown:

>
> - Frutas
>   - Maçã
>   - Banana
>   - Uva


### Links

- Você pode criar um link utilizando esta estrutura: `[texto](http://url-da-pagina.com)`.

Por exemplo:

|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
|`Você pode consultar mais [materiais sobre R nesta página](https://curso-r.com/material/).`| Você pode consultar mais [materiais sobre R nesta página](https://curso-r.com/material/).| 




### Equações

Você pode adicionar equações utilizando [LaTeX](https://pt.wikipedia.org/wiki/LaTeX).
Você pode saber mais na [página do Overleaf sobre expressões matemáticas](https://www.overleaf.com/learn/latex/mathematical_expressions).
Além disso, existem [geradores de equações online](https://www.codecogs.com/latex/eqneditor.php?latex=D) que ajudam a escrevâ-las em  LaTeX, HTML, entre outras linguagens de marcação.

É possível centralizar a equação envolvendo o código com `$$`. Veja o exemplo abaixo:


|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
|`$$y = \mu + \sum_{i=1}^p \beta_i x_i + \epsilon$$`| $$y = \mu + \sum_{i=1}^p \beta_i x_i + \epsilon$$ | 


Também é possível adicionar a equação na mesma linha que o texto, envolvendo o código com `$`. Veja o exemplo abaixo:


|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
|`Ou também na linha $y = \mu + \sum_{i=1}^p \beta_i x_i + \epsilon$ , junto ao texto!`| Ou também na linha $y = \mu + \sum_{i=1}^p \beta_i x_i + \epsilon$ , junto ao texto! | 

### Código

É possível __marcar textos para que fiquem formatados como códigos__, usando a crase: `

Mas atenção: o texto será formatado como código, e o mesmo não é executado!

>
>```
> `mean(pinguins$massa_corporal, na.rm = TRUE)`
> ```
>   `mean(pinguins$massa_corporal, na.rm = TRUE)`

|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
|`` `mean(pinguins$massa_corporal, na.rm = TRUE)` `` | `mean(pinguins$massa_corporal, na.rm = TRUE)` | 


Também é possível delimitar um trecho maior de código, utilizando três crases.

__Exemplo:__

__Como é escrito no código:__


```{r, echo=FALSE, fig.align='default'}
knitr::include_graphics("https://beatrizmilz.github.io/slidesR/markdown/images/markdowncode.PNG")
```

__Como aparece no relatório:__


```
library(dados)
mean(pinguins$massa_corporal, na.rm = TRUE)
```



### Imagens

- Você pode incluir um arquivo de imagem utilizando esta estrutura: `![descricao da imagem](http://url-da-imagem.com)`. Não se esqueça: a descrição da imagem é importante para
acessibilidade do conteúdo através de leitores de tela!


|  Como é escrito no código |  Como aparece no relatório |
|--:|--:|
|`![Logo da Curso-R](https://raw.githubusercontent.com/curso-r/site-v2/master/static/img/logo_cursor_full.png)`| ![Logo da Curso-R](https://raw.githubusercontent.com/curso-r/site-v2/master/static/img/logo_cursor_full.png)| 


### Tabelas

As tabelas em Markdown têm uma estrutura definida, como mostra o exemplo abaixo.

É possível usar [ferramentas online para gerar tabelas em Markdown](https://www.tablesgenerator.com/markdown_tables).

__Em Markdown:__
```{}
|  a|  b|  c|
|--:|--:|--:|
|  1|  2|  3|
|  2|  3|  4|
```


__Resultado:__

>
>
> |  a|  b|  c|
> |--:|--:|--:|
> |  1|  2|  3|
> |  2|  3|  4|


<!-- ## Adicionando elementos no seu relatório -->

<!-- ### Adicionar códigos usando R (em arquivos .Rmd) -->

<!-- Na sessão anterior, apresentamos como marcar o texto como código. Mas atenção: ele não é executado! -->

<!-- **Caso você queira que o código seja executado como código R**, existem duas possibilidades: -->

<!-- - 'inline code', quando o resultado aparece junto ao texto, e -->

<!-- - 'chunks de código' ou campos de código (chunks), quando o código fica destacado do corpo do texto. -->

<!-- <br> -->


<!-- #### Inline code (em arquivos .Rmd) -->

<!-- __Exemplo:__ -->

<!-- ```{r, echo=FALSE, fig.align='default', out.width="100%"} -->
<!-- knitr::include_graphics("https://raw.githubusercontent.com/beatrizmilz/slidesR/master/docs/markdown/images/r_inline_code2.PNG") -->
<!-- ``` -->

<!-- __Resultado:__ -->

<!-- >  A média da massa corporal dos pinguins é `r round(mean(dados::pinguins$massa_corporal, na.rm = TRUE)/ 1000, 1)` kg. -->

<!-- #### Campos de código (chunks) (em arquivos .Rmd) -->

<!-- É possível adicionar campos de código utilizando a seguinte sintaxe: -->

<!-- ```{r,  echo=FALSE, fig.align='default'} -->
<!-- knitr::include_graphics("https://raw.githubusercontent.com/beatrizmilz/slidesR/master/docs/markdown/images/campo-de-codigo.PNG") -->
<!-- ``` -->

<!-- Um exemplo de campo de código é o campo abaixo, onde é possível executar o código e visualizar o resultado. -->

<!-- ```{r exemplo-chunk, exercise = TRUE} -->
<!-- 1 + 1 -->
<!-- ``` -->

<!-- **Teste escrevendo códigos diferentes também!** -->


<!-- ### Adicionar imagens usando R (em arquivos .Rmd) -->

<!-- Neste tutorial foi apresentado como adicionar uma imagem utilizando Markdown. -->
<!-- Porém, quando utilizamos arquivos RMarkdown também é possível adicionar imagens usando código em R, com a função `include_graphics` do pacote `knitr`. -->
<!-- Usando o  `knitr` é possível personalizar de forma mais intuitiva como a imagem aparecerá no arquivo final: você pode adicionar uma imagem utilizando como primeiro argumento a url da imagem ou o caminho onde ela está no projeto. -->

<!-- Veja o exemplo abaixo (clique em `Run Code` para executar o código e ver o resultado): -->

<!-- ```{r exemplo-knitr, exercise=TRUE, out.width='50%'} -->
<!-- knitr::include_graphics("https://beatrizmilz.github.io/slidesR/introR/img/Hex/1dados-hex.png") -->
<!-- ``` -->

<!-- ### Adicionar tabelas usando R (em arquivos .Rmd) -->

<!-- Neste tutorial foi apresentado como adicionar uma tabela utilizando Markdown. -->
<!-- Porém quando utilizamos arquivos R Markdown também é possível adicionar tabelas usando código em R. Existem algumas funções diferentes para fazer isso, veja os exemplos abaixo (clique em `Run Code` para executar o código e ver o resultado): -->

<!-- Primeiro, carregue os pacotes necessários: -->

<!-- ```{r pacotes, echo=TRUE, exercise=TRUE} -->
<!-- # install.packages("remotes") -->
<!-- # remotes::install_github("cienciadedatos/dados") -->
<!-- library(dados)  # Pacote com bases de dados em Português -->
<!-- library(magrittr)  # Pacote para utilizar o Pipe %>% -->
<!-- ``` -->


<!-- - Adicione uma tabela utilizando o pacote `knitr`: função `kable()` -->

<!-- ```{r exemplo-kable, exercise=TRUE} -->
<!-- pinguins %>% -->
<!--   head() %>% -->
<!--   knitr::kable() -->
<!-- ``` -->


<!-- -  Adicione uma tabela utilizando o pacote `DT`: função `datatable()` -->

<!-- ```{r exemplo-DT, exercise=TRUE} -->
<!-- pinguins %>% -->
<!--   head() %>% -->
<!--   DT::datatable() -->
<!-- ``` -->

<!-- - Dependendo da forma que você gerar o arquivo R Markdown, bastará utilizar o nome da base para que ela seja apresentada de uma forma agradável: -->

<!-- ```{r exemplo-rmd, exercise=TRUE} -->
<!-- dados::pinguins -->
<!-- ``` -->


<!-- Obs: Existem outros pacotes que permitem adicionar tabelas bonitas nos arquivos R Markdown, como por exemplo: [reactable](https://glin.github.io/reactable/index.html), [flextable](https://davidgohel.github.io/flextable/articles/overview.html) e [kableExtra](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html) ! -->



<!-- ## Dicas para o RStudio -->

<!-- A versão mais recente do RStudio possui uma ferramenta de edição de Markdown visual, que disponibiliza botões para editar o texto com Markdown.  -->

<!-- Veja mais neste post: [RStudio versão 1.4 - Visual Markdown Editing](https://blog.rstudio.com/2020/09/30/rstudio-v1-4-preview-visual-markdown-editing/), e na animação disponível no post: -->


<!-- ```{r, out.width="80%", fig.cap="Demonstração do RStudio versão 1.4"} -->
<!-- knitr::include_graphics("https://blog.rstudio.com/2020/09/30/rstudio-v1-4-preview-visual-markdown-editing/images/visualmode-demo.gif") -->
<!-- ``` -->

